<!DOCTYPE html><html class="theme-next pisces use-motion" lang="en"><head><!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="BGEL63KNRW25AkpCy3shpRdMWDHE9LZTAFS3XSHtFK8"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css"><meta name="keywords" content="CodeSchool,JavaScript,ES2015,"><link rel="alternate" href="/atom.xml" title="Yuthon's blog" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2"><meta name="description" content="DeclarationUsing letUnderstanding Hoisting Prior to executing our code, JavaScript moves var declarations all the way up to the top of the scope. This is known as hoisting. 123456789101112131415161718"><meta name="keywords" content="CodeSchool,JavaScript,ES2015"><meta property="og:type" content="article"><meta property="og:title" content="Notes for Code School - ES2015"><meta property="og:url" content="http://www.yuthon.com/2016/04/10/CodeSchool-ES2015/index.html"><meta property="og:site_name" content="Yuthon&#39;s blog"><meta property="og:description" content="DeclarationUsing letUnderstanding Hoisting Prior to executing our code, JavaScript moves var declarations all the way up to the top of the scope. This is known as hoisting. 123456789101112131415161718"><meta property="og:locale" content="en"><meta property="og:image" content="http://www.yuthon.com/images/the_map_data_strcture.png"><meta property="og:image" content="http://www.yuthon.com/images/class_inheritance.png"><meta property="og:image" content="http://www.yuthon.com/images/fetching-poll-results-from-the-server.png"><meta property="og:image" content="http://www.yuthon.com/images/the-lifecycle-of%20a%20promise-object.png"><meta property="og:image" content="http://www.yuthon.com/images/iterables-return-iterators.png"><meta property="og:updated_time" content="2016-07-26T03:56:32.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Notes for Code School - ES2015"><meta name="twitter:description" content="DeclarationUsing letUnderstanding Hoisting Prior to executing our code, JavaScript moves var declarations all the way up to the top of the scope. This is known as hoisting. 123456789101112131415161718"><meta name="twitter:image" content="http://www.yuthon.com/images/the_map_data_strcture.png"><script type="text/javascript" id="hexo.configurations">var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };</script><link rel="canonical" href="http://www.yuthon.com/2016/04/10/CodeSchool-ES2015/"><title>Notes for Code School - ES2015 | Yuthon's blog</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-76233259-1', 'auto');
  ga('send', 'pageview');</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Yuthon's blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://www.yuthon.com/2016/04/10/CodeSchool-ES2015/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Yusu Pan"><meta itemprop="description" content=""><meta itemprop="image" content="/uploads/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Yuthon's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Notes for Code School - ES2015</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-04-10T12:09:29+08:00">2016-04-10 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">Post modified</span> <time title="Post modified" itemprop="dateModified" datetime="2016-07-26T11:56:32+08:00">2016-07-26 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2016/04/10/CodeSchool-ES2015/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/10/CodeSchool-ES2015/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="Declaration"><a href="#Declaration" class="headerlink" title="Declaration"></a>Declaration</h1><h2 id="Using-let"><a href="#Using-let" class="headerlink" title="Using let"></a>Using let</h2><p><strong>Understanding Hoisting</strong></p><p>Prior to executing our code, JavaScript moves var declarations all the way up to the top of the scope. This is known as hoisting.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; <span class="number">3</span>)&#123;</div><div class="line">    <span class="keyword">var</span> loadingMessage = <span class="string">"This might take a while..."</span>; </div><div class="line">    _displaySpinner(loadingMessage);</div><div class="line">    <span class="built_in">console</span>.log(flashMessage); <span class="comment">// undefined</span></div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">var</span> flashMessage = <span class="string">"Loading Profiles"</span>;</div><div class="line">    _displayFlash(flashMessage);</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(flashMessage); <span class="comment">// undefined</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// The function above will be hoisted by JavaScript as follows</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="comment">// Automatically moved here by the JavaScript runtime</span></div><div class="line">  <span class="keyword">var</span> loadingMessage, flashMessage;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; <span class="number">3</span>)&#123;</div><div class="line">    loadingMessage = <span class="string">"This might take a while..."</span>; </div><div class="line">    _displaySpinner(loadingMessage);</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    flashMessage = <span class="string">"Loading Profiles"</span>;</div><div class="line">    _displayFlash(flashMessage);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><a id="more"></a><p><strong>Declaring Variables With let</strong></p><p><code>let</code> variables are scoped to the nearest block and are NOT hoisted.</p><blockquote><p>A block is any code section within curly braces, like <code>if</code>, <code>else</code>, <code>for</code>, <code>while</code>, etc.</p></blockquote><p>Using <code>let</code>, variables are “trapped “inside their respective if and else blocks.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; <span class="number">3</span>)&#123;</div><div class="line">    <span class="keyword">let</span> loadingMessage = <span class="string">"This might take a while..."</span>; </div><div class="line">    _displaySpinner(loadingMessage);</div><div class="line">    <span class="built_in">console</span>.log(flashMessage); <span class="comment">// ReferenceError: flashMessage is not defined</span></div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">let</span> flashMessage = <span class="string">"Loading Profiles"</span>;</div><div class="line">    _displayFlash(flashMessage);</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(flashMessage); <span class="comment">// ReferenceError: flashMessage is not defined </span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Using-let-in-for-loops"><a href="#Using-let-in-for-loops" class="headerlink" title="Using let in for loops"></a>Using let in for loops</h2><p><strong>Loop Values in Callbacks</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> userNames)&#123;</div><div class="line">    _fetchProfile(<span class="string">"/users/"</span> + userNames[i], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"Fetched for "</span>, userNmaes[i]);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">loadProfiles([<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>, <span class="string">"Alex"</span>]);</div><div class="line"><span class="comment">// Outputs:</span></div><div class="line"><span class="comment">// Fetched for Alex</span></div><div class="line"><span class="comment">// Fetched for Alex</span></div><div class="line"><span class="comment">// Fetched for Alex</span></div><div class="line"><span class="comment">// Fetched for Alex</span></div></pre></td></tr></table></figure><ul><li><p><strong>Reason</strong></p><ol><li><p>variable <code>i</code> is hoisted to the top of the function and shared across each iteration of the loop.</p></li><li><p><code>fetchProfile</code> is called 4 times, before any of the callbacks are invoked.</p></li><li><p><code>i</code> is incremented on each iteration, finally it gets to <code>3</code>.</p></li><li><p>When callbacks begin to run, <code>i</code> holds the last value assigned to it from the for loop.</p></li><li><p>So callbacks prints <code>userNames[3]</code> all 4 times.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// By hoisting, The function above will be changed by JavaScript as follows</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> i;</div><div class="line">  <span class="keyword">for</span> (i <span class="keyword">in</span> userNames)&#123;</div><div class="line">    _fetchProfile(<span class="string">"/users/"</span> + userNames[i], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"Fetched for "</span>, userNmaes[i]);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol></li><li><p><strong>Soluition</strong>: Using <code>let</code> in for Loops</p><ul><li>With <code>let</code>, there’s no sharing in for loops. A new variable is created on each iteration.</li><li><p>Each callback function now holds a reference to their own version of <code>i</code>.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> userNames)&#123;</div><div class="line">    _fetchProfile(<span class="string">"/users/"</span> + userNames[i], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"Fetched for "</span>, userNmaes[i]);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">loadProfiles([<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>, <span class="string">"Alex"</span>]);</div><div class="line"><span class="comment">// Outputs:</span></div><div class="line"><span class="comment">// Fetched for Sam</span></div><div class="line"><span class="comment">// Fetched for Tyler</span></div><div class="line"><span class="comment">// Fetched for Brook</span></div><div class="line"><span class="comment">// Fetched for Alex</span></div></pre></td></tr></table></figure></li></ul></li></ul><p><strong><code>let</code> Cannot Be Redeclared</strong></p><p>Variables declared with <code>let</code> can be reassigned, but cannot be redeclared within the same scope.</p><h2 id="Using-const"><a href="#Using-const" class="headerlink" title="Using const"></a>Using const</h2><p><strong>Issues With Magic Numbers</strong></p><blockquote><p>Magic Numbers: A magic number is a literal value without a clear meaning.</p></blockquote><p>When used multiple times, magic numbers introduce unnecessary duplication, which can lead to bad code!</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; <span class="number">3</span>)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// Hard to tell whether both numbers serve the same purpose</span></div><div class="line">  <span class="keyword">if</span>(someValue &gt; <span class="number">3</span>)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Replacing Magic Numbers With Constants</strong></p><ul><li>The const keyword creates read-only named constants.</li><li>Once assigned, constants cannot be assigned a new value.</li><li>Variables declared with const must be assigned an initial value.</li><li>Variables declared with const are scoped to the nearest block.</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">const</span> MAX_USERS = <span class="number">3</span>;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; MAX_USERS)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">const</span> MAX_REPLIES = <span class="number">3</span>;</div><div class="line">  <span class="keyword">if</span>(someElement &gt; MAX_REPLIES)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>let vs. const</strong></p><p>In most cases, let and const will behave very similarly. Consider the semantics when choosing<br>one over the other.</p><ul><li>Use let when variables could be reassigned new values</li><li>Use const when new variables are not expected to be reassigned new values</li></ul><h1 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h1><h2 id="Function-Defaults"><a href="#Function-Defaults" class="headerlink" title="Function Defaults"></a>Function Defaults</h2><p><strong>Issues With Flexible Function Arguments</strong></p><p>Unexpected arguments might cause errors during function execution.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> namesLength = userNames.length;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">loadProfiles([<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>]); <span class="comment">// OK</span></div><div class="line"><span class="comment">// Breaks when called with no arguments</span></div><div class="line">loadProfiles(); <span class="comment">// TypeError: Cannot read property 'length' of undefined</span></div><div class="line">loadProfiles(<span class="literal">undefined</span>); <span class="comment">// TypeError: Cannot read property 'length' of undefined</span></div></pre></td></tr></table></figure><ul><li><p><strong>Manual Argument Checks Don’t Scale Well</strong></p><p>A common practice is to check for presence of arguments as the very first thing in the function.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> names = <span class="keyword">typeof</span> userNames !== <span class="string">'undefined'</span> ? userNames : [];</div><div class="line">  <span class="keyword">let</span> namesLength = names.length;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><strong>Using Default Parameter Values</strong></p><p>Default parameter values help move default values from the function body to the function signature.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Uses empty array as default valuewhen no argument is passed</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames = []</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> namesLength = userNames.length;</div><div class="line">  <span class="built_in">console</span>.log(namesLength);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Does not break when invoked with no arguments</span></div><div class="line">loadProfiles(); <span class="comment">// 0</span></div><div class="line"><span class="comment">// Nor with explicit undefined as argument</span></div><div class="line">loadProfiles( ); <span class="comment">// 0</span></div></pre></td></tr></table></figure></li></ul><p><strong>The Options Object</strong></p><p>The options object is a widely used pattern that allows user-defined settings to be passed to a function in the form of properties on an object.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">setPageThread(<span class="string">"New Version out Soon!"</span>, &#123;</div><div class="line">  popular: <span class="literal">true</span>,</div><div class="line">  expires: <span class="number">10000</span>,</div><div class="line">  activeClass: <span class="string">"is-page-thread"</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setPageThread</span>(<span class="params">name, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> popular = options.popular;</div><div class="line">  <span class="keyword">let</span> expires = options.expires;</div><div class="line">  <span class="keyword">let</span> activeClass = options.activeClass;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li><p><strong>Issues With the Options Object</strong></p><p>The options object makes it hard to know what options a function accepts.</p></li></ul><ul><li><p><strong>Using Named Parameters</strong></p><p>Using named parameters for optional settings makes it easier to understand how a function should be invoked.</p></li><li><p><strong>Omitting Certain Arguments on Call</strong></p><ul><li>It’s okay to omit some options when invoking a function with named parameters.</li><li>It’s NOT okay to omit the options argument altogether when invoking a function with named parameters when no default value is set for them.</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setPageThread</span>(<span class="params">name, &#123; popular, expires, activeClass &#125; = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Name: "</span>, name);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Popular: "</span>, popular);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Expires: "</span>, expires);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Active: "</span> , activeClass);</div><div class="line">&#125;</div><div class="line"></div><div class="line">setPageThread(<span class="string">"New Version out Soon!"</span>);</div><div class="line"><span class="comment">// Outputs:</span></div><div class="line"><span class="comment">// Name: New Version out Soon!</span></div><div class="line"><span class="comment">// Popular: undefined</span></div><div class="line"><span class="comment">// Expires: undefined</span></div><div class="line"><span class="comment">// Active: undefined</span></div></pre></td></tr></table></figure></li></ul><h2 id="Rest-Params-Spread-Op-Arrow-Func"><a href="#Rest-Params-Spread-Op-Arrow-Func" class="headerlink" title="Rest Params, Spread Op, Arrow Func"></a>Rest Params, Spread Op, Arrow Func</h2><h3 id="Rest-Parameters"><a href="#Rest-Parameters" class="headerlink" title="Rest Parameters"></a>Rest Parameters</h3><p><strong>Issues With the arguments Object</strong></p><p>The <code>arguments</code> object is a built-in, Array-like object that corresponds to the arguments of a function. Here’s why relying on this object to read arguments is not ideal:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Hard to tell which parameters this function expects to be called with</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayTags</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">// Where did this come from?!</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> <span class="built_in">arguments</span>)&#123;</div><div class="line">    <span class="keyword">let</span> tag = <span class="built_in">arguments</span>[i];</div><div class="line">    _addToTopic(tag);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// If we add an argument</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayTags</span>(<span class="params">targetElement</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> target = _findElement(targetElement);</div><div class="line">  <span class="comment">// We'll break the loop, since the first argument is no longer a tag</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> <span class="built_in">arguments</span>)&#123; </div><div class="line">    <span class="keyword">let</span> tag = <span class="built_in">arguments</span>[i];</div><div class="line">    _addToTopic(target, tag);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Using Rest Parameters</strong></p><p>The new rest parameter syntax allows us to represent an indefinite number of arguments as an Array. This way, changes to function signature are less likely to break code.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayTags</span>(<span class="params">...tags</span>)</span>&#123;</div><div class="line">  <span class="comment">// tags is an Array object</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> tags)&#123;</div><div class="line">    <span class="keyword">let</span> tag = [i];</div><div class="line">    _addToTopic(tag);</div><div class="line">  &#125;</div><div class="line">&#125;.</div><div class="line"></div><div class="line"><span class="comment">// ...tags must always go last</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayTags</span>(<span class="params">targetElement, ...tags</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> target = _findElement(targetElement);</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> tags)&#123;</div><div class="line">    <span class="keyword">let</span> tag = [i];</div><div class="line">    _addToTopic(target, tag);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Spread-Operator"><a href="#Spread-Operator" class="headerlink" title="Spread Operator"></a>Spread Operator</h3><p><strong>Splitting Arrays Into Individual Arguments</strong></p><p>We need a way to convert an Array into individual arguments upon a function call.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">getRequest(<span class="string">"/topics/17/tags"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> </span>)</span>&#123;</div><div class="line">  <span class="comment">// tags is an Array, e.g., ["programming", "web", "HTML"] ...</span></div><div class="line">  <span class="keyword">let</span> tags = data.tags;</div><div class="line">  <span class="comment">// but displayTags expects to be called with individual arguments</span></div><div class="line">  displayTags(tags);</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p><strong>Using the Spread Operator</strong></p><p>The spread operator allows us to split an Array argument into individual elements.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">getRequest(<span class="string">"/topics/17/tags"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> </span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> tags = data.tags;</div><div class="line">  <span class="comment">// The displayTags function is now receiving individual arguments, </span></div><div class="line">  <span class="comment">// not an Array</span></div><div class="line">  displayTags(...tags);</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p><strong>Rest and Spread look the same</strong></p><p>Rest parameters and the spread operator look the same, but the former is used in <strong>function definition</strong>s and the latter in <strong>function invocations</strong>.</p><h3 id="Arrow-Functions"><a href="#Arrow-Functions" class="headerlink" title="Arrow Functions"></a>Arrow Functions</h3><p><strong>Issues With Scope in Callback Functions</strong></p><p>Anonymous functions passed as callbacks to other functions create their own scope.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">TagComponent</span>(<span class="params">target, urlPath</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.targetElement = target;</div><div class="line">  <span class="keyword">this</span>.urlPath = urlPath;</div><div class="line">&#125;.</div><div class="line"></div><div class="line"><span class="comment">// The scope of the TagComponent object is not the same as </span></div><div class="line"><span class="comment">// the scope of the anonymous function</span></div><div class="line">TagComponent.prototype.render = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  getRequest(<span class="keyword">this</span>.urlPath, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    <span class="keyword">let</span> tags = data.tags;</div><div class="line">    displayTags(<span class="keyword">this</span>.targetElement, ...tags); <span class="comment">// Returns undefined</span></div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> tagComponent = <span class="keyword">new</span> TagComponent(targetDiv, <span class="string">"/topics/17/tags"</span>);</div><div class="line">tagComponent.render();</div></pre></td></tr></table></figure><p><strong>Using Arrow Functions to Preserve Scope</strong></p><p>Arrow functions bind to the scope of where they are defined, not where they are called. (also known as lexical binding)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">TagComponent</span>(<span class="params">target, urlPath</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.targetElement = target;</div><div class="line">  <span class="keyword">this</span>.urlPath = urlPath;</div><div class="line">&#125;.</div><div class="line"></div><div class="line">TagComponent.prototype.render = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">// Arrow functions bind to the lexical scope</span></div><div class="line">  getRequest(<span class="keyword">this</span>.urlPath, (data) =&gt; &#123;</div><div class="line">    <span class="keyword">let</span> tags = data.tags;</div><div class="line">    <span class="comment">// this now properly refers to the TagComponent object</span></div><div class="line">    displayTags(<span class="keyword">this</span>.targetElement, ...tags);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> tagComponent = <span class="keyword">new</span> TagComponent(targetDiv, <span class="string">"/topics/17/tags"</span>);</div><div class="line">tagComponent.render();</div></pre></td></tr></table></figure><h1 id="Objects-Strings-and-Object-assign"><a href="#Objects-Strings-and-Object-assign" class="headerlink" title="Objects, Strings, and Object.assign"></a>Objects, Strings, and Object.assign</h1><h2 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h2><p><strong>The Object Initializer Shorthand</strong></p><p>We can remove duplicate variable names from object properties when those properties have the same name as the variables being assigned to them.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildUser</span>(<span class="params">first, last</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> fullName = first + <span class="string">" "</span> + last;</div><div class="line">  <span class="keyword">return</span> &#123; first, last, fullName &#125;;</div><div class="line">  <span class="comment">// EQUAL TO</span></div><div class="line">  <span class="comment">// return &#123; first: first, last: last, fullName: fullName&#125;;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Object Destructuring</strong></p><p>We can use shorthand to assign properties from objects to local variables with the same name.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; first, last, fullName &#125; = buildUser(<span class="string">"Sam"</span>, <span class="string">"Williams"</span>);</div><div class="line"><span class="comment">// EQUAL TO</span></div><div class="line"><span class="comment">// let user = buildUser("Sam", "Williams");</span></div><div class="line"><span class="comment">// let first = user.first;</span></div><div class="line"><span class="comment">// let last = user.last;</span></div><div class="line"><span class="comment">// let fullName = user.fullName;</span></div><div class="line"></div><div class="line"><span class="comment">// Destructuring Selected Elements</span></div><div class="line"><span class="keyword">let</span> &#123; fullName &#125; = buildUser(<span class="string">"Sam"</span>, <span class="string">"Williams"</span>);</div></pre></td></tr></table></figure><p><strong>Using the Method Initializer Shorthand</strong></p><p>A new shorthand notation is available for adding a method to an object where the keyword function is no longer necessary.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildUser</span>(<span class="params">first, last, postCount</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> fullName = first + <span class="string">" "</span> + last;</div><div class="line">  <span class="keyword">const</span> ACTIVE_POST_COUNT = <span class="number">10</span>;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    first,</div><div class="line">    last,</div><div class="line">    fullName, </div><div class="line">    isActive()&#123; <span class="comment">// EQUAL TO isActive: function()&#123;&#125;</span></div><div class="line">      <span class="keyword">return</span> postCount &gt;= ACTIVE_POST_COUNT;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h2><p><strong>Template Strings</strong></p><p>Template strings are string literals allowing embedded expressions. This allows for a much better way to do string interpolation.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildUser</span>(<span class="params">first, last, postCount</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> fullName = <span class="string">`<span class="subst">$&#123;first&#125;</span> <span class="subst">$&#123;last&#125;</span>`</span>;</div><div class="line">  <span class="comment">// EQUAL TO</span></div><div class="line">  <span class="comment">// let fullName = first + " " + last;</span></div><div class="line">  <span class="keyword">const</span> ACTIVE_POST_COUNT = <span class="number">10</span>;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Writing Multi-line Strings</strong></p><p>Template strings offer a new - and much better - way to write multi-line strings.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> userName = <span class="string">"Sam"</span>;</div><div class="line"><span class="keyword">let</span> admin = &#123; <span class="attr">fullName</span>: <span class="string">"Alex Williams"</span> &#125;;</div><div class="line"><span class="keyword">let</span> veryLongText = <span class="string">`Hi <span class="subst">$&#123;userName&#125;</span>,</span></div><div class="line"><span class="string">  this is a very</span></div><div class="line"><span class="string">  very</span></div><div class="line"><span class="string">  veeeery</span></div><div class="line"><span class="string">  long text.</span></div><div class="line"><span class="string">  Regards,</span></div><div class="line"><span class="string">    <span class="subst">$&#123;admin.fullName&#125;</span></span></div><div class="line"><span class="string">`</span>;</div></pre></td></tr></table></figure><blockquote><p>Template Strings use <strong>back-ticks (``)</strong> rather than the single or double quotes we’re used to with regular strings.</p></blockquote><h2 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign"></a>Object.assign</h2><p><strong>Using Too Many Arguments Is Bad</strong></p><p>For functions that need to be used across different applications, it’s okay to accept an options object instead of using named parameters</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Too many named arguments make this function harder to read</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft,</span></span></div><div class="line"><span class="function"><span class="params">                         &#123; container, timeUnit, clonedDataAttribute,</span></span></div><div class="line"><span class="function"><span class="params">                         timeoutClass, timeoutSoonClass, timeoutSoonSeconds </span></span></div><div class="line"><span class="function"><span class="params">                         &#125; = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Easier to customize to different applications</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Using Local Values and || Is Bad for Defaults</strong></p><p>Some options might not be specified by the caller, so we need to have default values.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="comment">// Default strings and numbers are all over the place... Yikes!</span></div><div class="line">  <span class="keyword">let</span> container = options.container || <span class="string">".timer-display"</span>;</div><div class="line">  <span class="keyword">let</span> timeUnit = options.timeUnit || <span class="string">"seconds"</span>;</div><div class="line">  <span class="keyword">let</span> clonedDataAttribute = options.clonedDataAttribute || <span class="string">"cloned"</span>;</div><div class="line">  <span class="keyword">let</span> timeoutClass = options.timeoutClass || <span class="string">".is-timeout"</span>;</div><div class="line">  <span class="keyword">let</span> timeoutSoonClass = options.timeoutSoonClass || <span class="string">".is-timeout-soon"</span>;</div><div class="line">  <span class="keyword">let</span> timeoutSoonTime = options.timeoutSoonSeconds || <span class="number">10</span>;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Using a Local Object to Group Defaults</strong></p><p>Using a local object to group default values for user options is a common practice and can help write more idiomatic JavaScript.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> defaults = &#123;</div><div class="line">    container: <span class="string">".timer-display"</span>,</div><div class="line">    timeUnit: <span class="string">"seconds"</span>,</div><div class="line">    clonedDataAttribute: <span class="string">"cloned"</span>,</div><div class="line">    timeoutClass: <span class="string">".is-timeout"</span>,</div><div class="line">    timeoutSoonClass: <span class="string">".is-timeout-soon"</span>,</div><div class="line">    timeoutSoonTime: <span class="number">10</span></div><div class="line">  &#125;;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Merging Values With Object.assign</strong></p><p>The <code>Object.assign</code> method copies properties from one or more source objects to a target object specified as the very first argument.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> defaults = &#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="comment">// Merged properties from defaults and options</span></div><div class="line">  <span class="comment">// Target object is modified and used as return value</span></div><div class="line">  <span class="comment">// Source objects remain unchanged</span></div><div class="line">  <span class="keyword">let</span> settings = <span class="built_in">Object</span>.assign(&#123;&#125;, defaults, options);</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Merging Objects With Duplicate Properties</strong></p><p>In case of duplicate properties on source objects, the value from the last object on the chain always prevails.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> defaults = &#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="comment">// Duplicate properties from options3 override those on options2, </span></div><div class="line">  <span class="comment">// which override those on options, etc.</span></div><div class="line">  <span class="keyword">let</span> settings = <span class="built_in">Object</span>.assign(&#123;&#125;, defaults, options, options2, options3);</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Using Object.assign</strong></p><p>There are a couple incorrect ways we might see Object.assign being used.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// NOT recommanded</span></div><div class="line"><span class="comment">// defaults is mutated, so we can't go back and access original default</span></div><div class="line"><span class="comment">// values after the merge</span></div><div class="line"><span class="built_in">Object</span>.assign(defaults, options);</div><div class="line"></div><div class="line"><span class="comment">// Recommanded</span></div><div class="line"><span class="comment">// Can access original default values and looks functional</span></div><div class="line"><span class="keyword">let</span> settings = <span class="built_in">Object</span>.assign(&#123;&#125;, defaults, options);</div><div class="line"></div><div class="line"><span class="comment">// NOT recommanded</span></div><div class="line"><span class="comment">// Default values are not changed, but settings is passed as a reference</span></div><div class="line"><span class="keyword">let</span> settings = &#123;&#125;;</div><div class="line"><span class="comment">// Not reading return value</span></div><div class="line"><span class="built_in">Object</span>.assign(settings, defaults, options);</div></pre></td></tr></table></figure><p><strong>Reading Initial Default Values</strong></p><p>Preserving the original default values gives us the ability to compare them with the options passed and act accordingly when necessary.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countdownTimer</span>(<span class="params">target, timeLeft, options = &#123;&#125;</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> defaults = &#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;;</div><div class="line">  </div><div class="line">  <span class="keyword">let</span> settings = <span class="built_in">Object</span>.assign(&#123;&#125;, defaults, options);</div><div class="line">  </div><div class="line">  <span class="comment">// Runs when value passed as argument for timeUnit is different than the original value</span></div><div class="line">  <span class="keyword">if</span>(settings.timeUnit !== defaults.timeUnit)&#123;</div><div class="line">    _conversionFunction(timeLeft, settings.timeUnit)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="Arrays-Maps-and-Sets"><a href="#Arrays-Maps-and-Sets" class="headerlink" title="Arrays, Maps, and Sets"></a>Arrays, Maps, and Sets</h1><h2 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h2><h3 id="Array-Destructuring"><a href="#Array-Destructuring" class="headerlink" title="Array Destructuring"></a>Array Destructuring</h3><p><strong>Reading Values With Array Destructuring</strong></p><p>We can use destructuring to assign multiple values from an array to local variables.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> users = [<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>];</div><div class="line"><span class="keyword">let</span> a b c [ ] , , = users;</div><div class="line"><span class="built_in">console</span>.log( a, b, c ); <span class="comment">// Sam Tyler Brook</span></div></pre></td></tr></table></figure><p>Values can be discarded</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [a, , b] = users;</div><div class="line"><span class="built_in">console</span>.log( a, b ); <span class="comment">// Sam Brook</span></div></pre></td></tr></table></figure><p><strong>Combining Destructuring With Rest Params</strong></p><p>We can combine destructuring with rest parameters to group values into other arrays.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> users = [<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>];</div><div class="line"><span class="keyword">let</span> [ first, ...rest ] = users;</div><div class="line"><span class="built_in">console</span>.log( first, rest ); <span class="comment">// Sam ["Tyler", "Brook"]</span></div></pre></td></tr></table></figure><p><strong>Destructuring Arrays From Return Values</strong></p><p>When returning arrays from functions, we can assign to multiple variables at once.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">activeUsers</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> users = [<span class="string">"Sam"</span>, <span class="string">"Alex"</span>, <span class="string">"Brook"</span>];</div><div class="line">  <span class="keyword">return</span> users;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> active = activeUsers();</div><div class="line"><span class="built_in">console</span>.log( active ); <span class="comment">// ["Sam", "Alex", "Brook"] </span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [a, b, c] = activeUsers();</div><div class="line"><span class="built_in">console</span>.log( a, b, c ); <span class="comment">// Sam Alex Brook</span></div></pre></td></tr></table></figure><h3 id="for…of"><a href="#for…of" class="headerlink" title="for…of"></a>for…of</h3><p><strong>Using for…of to Loop Over Arrays</strong></p><p>The for…of statement iterates over property values, and it’s a better way to loop over arrays and other iterable objects.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> names = [<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>];</div><div class="line"></div><div class="line"><span class="comment">// Uses index to read actual element</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> index <span class="keyword">in</span> names)&#123;</div><div class="line">  <span class="built_in">console</span>.log( names[index] ); <span class="comment">// Sam Tyler Brook </span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Reads element directly and with less code involved</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> name <span class="keyword">of</span> names)&#123;</div><div class="line">  <span class="built_in">console</span>.log( name ); <span class="comment">// Sam Tyler Brook </span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Limitations of for…of and Objects</strong></p><p>The for…of statement cannot be used to iterate over properties in plain JavaScript objects out-of-the-box.</p><p>In order to work with for…of, objects need a special function assigned to the Symbol.iterator<br>property. The presence of this property allows us to know whether an object is iterable.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Objects That Work With for...of</span></div><div class="line"><span class="keyword">let</span> names = [<span class="string">"Sam"</span>, <span class="string">"Tyler"</span>, <span class="string">"Brook"</span>];</div><div class="line"><span class="built_in">console</span>.log( <span class="keyword">typeof</span> names[<span class="built_in">Symbol</span>.iterator] ); <span class="comment">// function</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> name <span class="keyword">of</span> names)&#123;</div><div class="line">  <span class="built_in">console</span>.log( name ); <span class="comment">// Sam Tyler Brook </span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Objects That Don't Work With for...of</span></div><div class="line"><span class="keyword">let</span> post = &#123;</div><div class="line">  title: <span class="string">"New Features in JS"</span>,</div><div class="line">  replies: <span class="number">19</span>,</div><div class="line">  lastReplyFrom: <span class="string">"Sam"</span></div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log( <span class="keyword">typeof</span> post[<span class="built_in">Symbol</span>.iterator] ); <span class="comment">// undefined</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> property <span class="keyword">of</span> post)&#123;</div><div class="line">  <span class="built_in">console</span>.log( property );</div><div class="line">  <span class="comment">// TypeError: post[Symbol.iterator] is not a function</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Array-find"><a href="#Array-find" class="headerlink" title="Array.find"></a>Array.find</h3><p><strong>Finding an Element in an Array</strong></p><p>Array.find returns the first element in the array that satisfies a provided testing function.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> users = [</div><div class="line">  &#123; <span class="attr">login</span>: <span class="string">"Sam"</span>,   <span class="attr">admin</span>: <span class="literal">false</span> &#125;,</div><div class="line">  &#123; <span class="attr">login</span>: <span class="string">"Brook"</span>, <span class="attr">admin</span>: <span class="literal">true</span>  &#125;,</div><div class="line">  &#123; <span class="attr">login</span>: <span class="string">"Tyler"</span>, <span class="attr">admin</span>: <span class="literal">true</span>  &#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">// Returns first object for which user.admin is true</span></div><div class="line"><span class="keyword">let</span> admin = users.find( <span class="function">(<span class="params">user</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> user.admin;</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log( admin ); <span class="comment">// &#123; "login" : "Brook", "admin" : true &#125;</span></div><div class="line"></div><div class="line"><span class="comment">// One-liner arrow function</span></div><div class="line"><span class="keyword">let</span> admin = users.find( <span class="function"><span class="params">user</span> =&gt;</span> user.admin );</div><div class="line"><span class="built_in">console</span>.log( admin ); <span class="comment">// &#123; "login" : "Brook", "admin" : true &#125;</span></div></pre></td></tr></table></figure><h2 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h2><h3 id="Maps-and-Objects"><a href="#Maps-and-Objects" class="headerlink" title="Maps and Objects"></a>Maps and Objects</h3><p><strong>The Map Data Structure</strong></p><p><img src="/images/the_map_data_strcture.png" alt="the_map_data_strcture"></p><p><strong>Issues With Using Objects as Maps</strong></p><p>When using Objects as maps, its keys are always converted to strings.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Two different objects</span></div><div class="line"><span class="keyword">let</span> user1 = &#123; <span class="attr">name</span>: <span class="string">"Sam"</span> &#125;;</div><div class="line"><span class="keyword">let</span> user2 = &#123; <span class="attr">name</span>: <span class="string">"Tyler"</span> &#125;;</div><div class="line"></div><div class="line"><span class="comment">// Both objects are converted to the string "[object Object]"</span></div><div class="line"><span class="keyword">let</span> totalReplies = &#123;&#125;;</div><div class="line">totalReplies[user1] = <span class="number">5</span>;</div><div class="line">totalReplies[user2] = <span class="number">42</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( totalReplies[user1] ); <span class="comment">// 42</span></div><div class="line"><span class="built_in">console</span>.log( totalReplies[user2] ); <span class="comment">// 42</span></div><div class="line"><span class="built_in">console</span>.log( <span class="built_in">Object</span>.keys(totalReplies) ); <span class="comment">//  ["[object Object]"]</span></div></pre></td></tr></table></figure><p><strong>Storing Key/Values With Map</strong></p><p>The Map object is a simple key/value data structure. Any value may be used as either a key or a value, and objects are not converted to strings.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> user1 = &#123; <span class="attr">name</span>: <span class="string">"Sam"</span> &#125;;</div><div class="line"><span class="keyword">let</span> user2 = &#123; <span class="attr">name</span>: <span class="string">"Tyler"</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> totalReplies = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">totalReplies.set( user1, <span class="number">5</span> );</div><div class="line">totalReplies.set( user2, <span class="number">42</span> );</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( totalReplies.get(user1) ); <span class="comment">// 5</span></div><div class="line"><span class="built_in">console</span>.log( totalReplies.get(user2) ); <span class="comment">// 42</span></div></pre></td></tr></table></figure><blockquote><p>We use the <code>get()</code> and <code>set()</code> methods to access values in Maps</p></blockquote><p><strong>Use Maps When Keys Are Unknown Until Runtime</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> recentPosts = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">createPost(newPost, (data) =&gt; &#123;</div><div class="line">  <span class="comment">// Keys unknown until runtime, so... Map!</span></div><div class="line">  recentPosts.set( data.author, data.message );</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> POSTS_PER_PAGE = <span class="number">15</span>;</div><div class="line"><span class="keyword">let</span> userSettings = &#123;</div><div class="line">  <span class="comment">// Keys are previously defined, so... Object!</span></div><div class="line">  perPage: POSTS_PER_PAGE,</div><div class="line">  showRead: <span class="literal">true</span>,</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p><strong>Use Maps When Types Are the Same</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> recentPosts = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">createPost(newPost, (data) =&gt; &#123;</div><div class="line">  recentPosts.set( data.author, data.message );</div><div class="line">&#125;);</div><div class="line"><span class="comment">// ...somewhere else in the code</span></div><div class="line">socket.on(<span class="string">'new post'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">  <span class="comment">// All keys are the same type, </span></div><div class="line">  <span class="comment">// and all values are the same type, so Map!</span></div><div class="line">  recentPosts.set( data.author, data.message );</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> POSTS_PER_PAGE = <span class="number">15</span>;</div><div class="line"><span class="keyword">let</span> userSettings = &#123;</div><div class="line">  <span class="comment">// Some values are numeric, others are boolean, so Object!</span></div><div class="line">  perPage: POSTS_PER_PAGE,</div><div class="line">  showRead: <span class="literal">true</span>,</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p><strong>Iterating Maps With for…of</strong></p><p><code>Maps</code> are iterable, so they can be used in a <code>for...of</code> loop. Each run of the loop returns a [key, value] pair for an entry in the Map.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> mapSettings = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line">mapSettings.set( <span class="string">"user"</span>, <span class="string">"Sam"</span> );</div><div class="line">mapSettings.set( <span class="string">"topic"</span>, <span class="string">"ES2015"</span> );</div><div class="line">mapSettings.set( <span class="string">"replies"</span>, [<span class="string">"Can't wait!"</span>, <span class="string">"So Cool"</span>] );</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> [key, value] <span class="keyword">of</span> mapSettings)&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> = <span class="subst">$&#123;value&#125;</span>`</span>);</div><div class="line">  <span class="comment">// user = Sam</span></div><div class="line">  <span class="comment">// topic = ES2015</span></div><div class="line">  <span class="comment">// replies = Can't wait!,So Cool</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h3><p>The WeakMap is a type of Map where only objects can be passed as keys. Primitive data types - such as strings, numbers, booleans, etc. - are not allowed.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> user = &#123;&#125;;</div><div class="line"><span class="keyword">let</span> comment = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> mapSettings = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line">mapSettings.set( user, <span class="string">"user"</span> );</div><div class="line">mapSettings.set( comment, <span class="string">"comment"</span> );</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( mapSettings.get(user) ); <span class="comment">//  user</span></div><div class="line"><span class="built_in">console</span>.log( mapSettings.get(comment) ); <span class="comment">// comment</span></div><div class="line"></div><div class="line">mapSettings.set(<span class="string">"title"</span>, <span class="string">"ES2015"</span>); <span class="comment">// Invalid value used as weak map key</span></div></pre></td></tr></table></figure><ul><li><p><strong>All available methods on a WeakMap require access to an object used as a key.</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> user = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> mapSettings = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line">mapSettings.set( user, );</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( mapSettings.get(user) ); <span class="comment">// ES2015</span></div><div class="line"><span class="built_in">console</span>.log( mapSettings.has(user) ); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log( mapSettings.delete(user) ); <span class="comment">// true</span></div></pre></td></tr></table></figure></li><li><p><strong>WeakMaps are not iterable, therefore they can’t be used with for…of</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> [key,value] <span class="keyword">of</span> mapSettings)&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> = <span class="subst">$&#123;value&#125;</span>`</span>);</div><div class="line">  <span class="comment">// mapSettings[Symbol.iterator] is not a function</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><strong>WeakMaps Are Better With Memory</strong></p><p>Individual entries in a WeakMap can be garbage collected while the WeakMap itself still exists.</p></li></ul><h2 id="Sets"><a href="#Sets" class="headerlink" title="Sets"></a>Sets</h2><h3 id="Sets-and-Arrays"><a href="#Sets-and-Arrays" class="headerlink" title="Sets and Arrays"></a>Sets and Arrays</h3><p><strong>Limitations With Arrays</strong></p><p>Arrays don’t enforce uniqueness of items. Duplicate entries are allowed.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tags = [];</div><div class="line"></div><div class="line">tags.push( <span class="string">"JavaScript"</span> );</div><div class="line">tags.push( <span class="string">"Programming"</span> );</div><div class="line">tags.push( <span class="string">"Web"</span> );</div><div class="line">tags.push( <span class="string">"Web"</span> ); <span class="comment">// Duplicate entry</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( <span class="string">"Total items "</span>, tags.length ); <span class="comment">// Total items 4</span></div></pre></td></tr></table></figure><p><strong>Using Set</strong></p><p>The <code>Set</code> object stores unique values of any type, whether primitive values or object references.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tags = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"></div><div class="line">tags.add(<span class="string">"JavaScript"</span>);</div><div class="line"><span class="comment">// Both primitive values and objects are allowed</span></div><div class="line">tags.add(<span class="string">"Programming"</span>);</div><div class="line">tags.add(&#123; <span class="attr">version</span>: <span class="string">"2015"</span> &#125;);</div><div class="line">tags.add(<span class="string">"Web"</span>);</div><div class="line">tags.add(<span class="string">"Web"</span>); <span class="comment">// Duplicate entries are ignored</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"Total items "</span>, tags.size); <span class="comment">// Total items 4</span></div></pre></td></tr></table></figure><p><strong>Using Set as Enumerable Object</strong></p><p><code>Set</code> objects are iterable, which means they can be used with <code>for...of</code> and destructuring.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tags = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"></div><div class="line">tags.add(<span class="string">"JavaScript"</span>);</div><div class="line">tags.add(<span class="string">"Programming"</span>);</div><div class="line">tags.add(&#123; <span class="attr">version</span>: <span class="string">"2015"</span> &#125;);</div><div class="line">tags.add(<span class="string">"Web"</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> tag <span class="keyword">of</span> tags)&#123;</div><div class="line">  <span class="built_in">console</span>.log(tag);</div><div class="line">&#125;</div><div class="line"><span class="comment">// OUTPUTS:</span></div><div class="line"><span class="comment">// JavaScript</span></div><div class="line"><span class="comment">// Programming</span></div><div class="line"><span class="comment">// &#123; version: '2015' &#125;</span></div><div class="line"><span class="comment">// Web</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [a,b,c,d] = tags;</div><div class="line"><span class="built_in">console</span>.log(a, b, c, d);</div><div class="line"><span class="comment">// OUTPUTS:</span></div><div class="line"><span class="comment">// JavaScript Programming &#123; version: '2015' &#125; Web</span></div></pre></td></tr></table></figure><h3 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h3><ul><li>The <code>WeakSet</code> is a type of Set where <strong>only objects</strong> are allowed to be stored.</li></ul><ul><li><code>WeakSets</code> don’t prevent the garbage collector from collecting entries that are no longer used in other parts of the system</li></ul><ul><li><code>WeakSets</code> cannot be used with <code>for...of</code> and they offer <strong>no methods for reading values from it</strong>.</li></ul><p><strong>Using WeakSets to Show Unread Posts</strong></p><ul><li>We want to add a different background color to posts that have not yet been read.</li></ul><ul><li>We can use WeakSets to create special groups from existing objects without mutating them.</li></ul><ul><li>Favoring immutable objects allows for much simpler code with no unexpected side effects.</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> readPosts = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</div><div class="line"></div><div class="line"><span class="comment">//...when post is clicked on</span></div><div class="line">postList.addEventListener(<span class="string">'click'</span>, (event) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  <span class="comment">// Adds object to a group of read posts</span></div><div class="line">  readPosts.add(post);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ...rendering posts</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> post <span class="keyword">of</span> postArray)&#123;</div><div class="line">  <span class="comment">// The has() method checks whether </span></div><div class="line">  <span class="comment">// an object is present in the WeakSet</span></div><div class="line">  <span class="keyword">if</span>(!readPosts.has(post))&#123;</div><div class="line">    _addNewPostClass(post.element);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="Classes-and-Modules"><a href="#Classes-and-Modules" class="headerlink" title="Classes and Modules"></a>Classes and Modules</h1><h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><p><strong>Using a Function Approach</strong></p><p>A common approach to encapsulation in JavaScript is using a constructor function.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SponsorWidget</span>(<span class="params">name, description, url</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name;</div><div class="line">  <span class="keyword">this</span>.description = description;</div><div class="line">  <span class="keyword">this</span>.url = url;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Too verbose!</span></div><div class="line">SponsorWidget.prototype.render = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// Invoking the SponsorWidget function looks like this:</span></div><div class="line"><span class="keyword">let</span> sponsorWidget = <span class="keyword">new</span> SponsorWidget(name, description, url);</div><div class="line">sponsorWidget.render();</div></pre></td></tr></table></figure><p><strong>Using the New Class Syntax</strong></p><p>To define a class, we use the class keyword followed by the name of the class. The body of a class is the part between curly braces.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SponsorWidget</span> </span>&#123;</div><div class="line">  <span class="comment">// Runs every time a new instance is created with the new operator</span></div><div class="line">  <span class="keyword">constructor</span>(name, description, url)&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">    <span class="comment">// Don't forget to use this to access instance properties and methods</span></div><div class="line">    <span class="keyword">this</span>.url = url;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// Can access previously assigned instance variables</span></div><div class="line">  render()&#123;</div><div class="line">    <span class="keyword">let</span> link = <span class="keyword">this</span>._buildLink(<span class="keyword">this</span>.url);</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Prefixing a method with an underscore is a</span></div><div class="line">  <span class="comment">// convention for indicating that it should not</span></div><div class="line">  <span class="comment">// be invoked from the public API</span></div><div class="line">  _buildLink(url)&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> sponsorWidget = <span class="keyword">new</span> SponsorWidget(name, description, url);</div><div class="line">sponsorWidget.render();</div></pre></td></tr></table></figure><p><strong>Class Inheritance</strong></p><p>We can use class inheritance to reduce code repetition. Child classes inherit and specialize behavior defined in parent classes.</p><p><img src="/images/class_inheritance.png" alt="cass_inheritance"></p><p><strong>Using extends to Inherit From Base Class</strong></p><p>The <code>extends</code> keyword is used to create a class that inherits methods and properties from another class. The <code>super</code> method runs the constructor function from the parent class.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Parent Class</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">this</span>.baseCSS = <span class="string">"site-widget"</span>;</div><div class="line">  &#125;</div><div class="line">  parse(value)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Child Class</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SponsorWidget</span> <span class="keyword">extends</span> <span class="title">Widget</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(name, description, url)&#123;</div><div class="line">    <span class="comment">// runs parent's setup code</span></div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">  render()&#123;</div><div class="line">    <span class="keyword">let</span> parsedName = <span class="keyword">this</span>.parse(<span class="keyword">this</span>.name);</div><div class="line">    <span class="keyword">let</span> css = <span class="keyword">this</span>._buildCSS(<span class="keyword">this</span>.baseCSS);</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>Overriding Inherited Methods</strong></p><p>Child classes can invoke methods from their parent classes via the super object.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Parent Class</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">this</span>.baseCSS = <span class="string">"site-widget"</span>;</div><div class="line">  &#125;</div><div class="line">  parse(value)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Child Class</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SponsorWidget</span> <span class="keyword">extends</span> <span class="title">Widget</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(name, description, url)&#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">  parse()&#123;</div><div class="line">    <span class="comment">// Calls the parent version of the parse() method</span></div><div class="line">    <span class="keyword">let</span> parsedName = <span class="keyword">super</span>.parse(<span class="keyword">this</span>.name);</div><div class="line">    <span class="keyword">return</span> <span class="string">`Sponsor: <span class="subst">$&#123;parsedName&#125;</span>`</span>;</div><div class="line">  &#125;</div><div class="line">  render()&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h2><h3 id="Function-Modules"><a href="#Function-Modules" class="headerlink" title="Function Modules"></a>Function Modules</h3><p><strong>Polluting the Global Namespace</strong></p><p>The common solution for modularizing code relies on using global variables. This increases the chances of unexpected side effects and potential naming conflicts.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- Libraries add to the global namespace --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./underscore.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./flash-message.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Global variables can cause naming conflicts</span></div><div class="line"><span class="keyword">let</span> element = $(<span class="string">"..."</span>).find(...);</div><div class="line"><span class="keyword">let</span> filtered = _.each(...);</div><div class="line">flashMessage(<span class="string">"Hello"</span>);</div></pre></td></tr></table></figure><p><strong>Creating Modules</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// flash-message.js</span></div><div class="line"><span class="comment">// The export keyword exposes this function to the module system</span></div><div class="line"><span class="comment">// The default type export is the simplest way to export a function</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>&#123;</div><div class="line">  alert(message);</div><div class="line">&#125;</div><div class="line">  </div><div class="line"><span class="comment">// app.js</span></div><div class="line"><span class="comment">// Can be named anything because it's default export</span></div><div class="line"><span class="keyword">import</span> flashMessage <span class="keyword">from</span> <span class="string">'./flash-message'</span>;</div><div class="line">flashMessage(<span class="string">"Hello"</span>);</div></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- Not adding to the global namespace --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./flash-message.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>Using Named Exports</strong></p><p>In order to export multiple functions from a single module, we can use the named export.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// flash-message.js</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> (<span class="params">message</span>)</span>&#123;</div><div class="line">  alert(message);</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">logMessage</span>(<span class="params">message</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(message);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// app.js</span></div><div class="line"><span class="keyword">import</span> &#123; alertMessage, logMessage &#125; <span class="keyword">from</span> <span class="string">'./flash-message'</span>;</div><div class="line">alertMessage(<span class="string">'Hello from alert'</span>);</div><div class="line">logMessage(<span class="string">'Hello from log'</span>);</div></pre></td></tr></table></figure><p><strong>Importing a Module as an Object</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app.js</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> flash <span class="keyword">from</span> <span class="string">'./flash-message'</span>;</div><div class="line"></div><div class="line">flash.alertMessage(<span class="string">'Hello from alert'</span>);</div><div class="line">falsh.logMessage(<span class="string">'Hello from log'</span>);</div></pre></td></tr></table></figure><p><strong>Removing Repeated Export Statements</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// flash-message.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">alertMessage</span>(<span class="params">message</span>)</span>&#123;</div><div class="line">  alert(message);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logMessage</span>(<span class="params">message</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(message);</div><div class="line">&#125;</div><div class="line"><span class="comment">// export can take multiple function names between curly braces</span></div><div class="line"><span class="keyword">export</span> &#123; alertMessage, logMessage &#125;;</div><div class="line"></div><div class="line"><span class="comment">// app.js</span></div><div class="line"><span class="comment">// Imported just like before</span></div><div class="line"><span class="keyword">import</span> &#123; alertMessage, logMessage &#125; <span class="keyword">from</span> <span class="string">'./flash-message'</span>;</div><div class="line">alertMessage(<span class="string">'Hello from alert'</span>);</div><div class="line">logMessage(<span class="string">'Hello from log'</span>);</div></pre></td></tr></table></figure><h3 id="Export-and-import-Constants"><a href="#Export-and-import-Constants" class="headerlink" title="Export and import Constants"></a>Export and import Constants</h3><p><strong>Extracting Hardcoded Constants</strong></p><p>Redefining constants across our application is unnecessary repetition and can lead to bugs.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// load-profiles.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">const</span> MAX_USERS = <span class="number">3</span>;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; MAX_USERS)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">const</span> MAX_REPLIES = <span class="number">3</span>;</div><div class="line">  <span class="keyword">if</span>(someElement &gt; MAX_REPLIES)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> &#123; loadProfiles &#125;</div><div class="line"></div><div class="line"><span class="comment">// list-replies.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listReplies</span>(<span class="params">replies=[]</span>)</span>&#123;</div><div class="line">  <span class="keyword">const</span> MAX_REPLIES = <span class="number">3</span>;</div><div class="line">  <span class="keyword">if</span>(replies.length &gt; MAX_REPLIES)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> &#123; listReplies &#125;</div><div class="line"></div><div class="line"><span class="comment">// display-watchers.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayWatchers</span>(<span class="params">watchers=[]</span>)</span>&#123;</div><div class="line">  <span class="keyword">const</span> MAX_USERS = <span class="number">3</span>;</div><div class="line">  <span class="keyword">if</span>(watchers.length &gt; MAX_USERS)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> &#123; displayWatchers &#125;</div></pre></td></tr></table></figure><p><strong>Export Constants</strong></p><p>Placing constants on their own module allows them to be reused across other modules and hides implementation details (a.k.a., encapsulation).</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// constants.js</span></div><div class="line"><span class="keyword">const</span> MAX_USERS = <span class="number">3</span>;</div><div class="line"><span class="keyword">const</span> MAX_REPLIES = <span class="number">3</span>;</div><div class="line"><span class="keyword">export</span> &#123; MAX_USERS, MAX_REPLIES &#125;;</div></pre></td></tr></table></figure><p><strong>Import Constants</strong></p><p>To import constants, we can use the exact same syntax for importing functions.</p><p>We can now import and use our constants from other places in our application.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// load-profiles.js</span></div><div class="line"><span class="keyword">import</span> &#123; MAX_REPLIES, MAX_USERS &#125; <span class="keyword">from</span> <span class="string">'./constants'</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadProfiles</span>(<span class="params">userNames</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(userNames.length &gt; MAX_USERS)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(someElement &gt; MAX_REPLIES)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// list-replies.js</span></div><div class="line"><span class="keyword">import</span> &#123; MAX_REPLIES &#125; <span class="keyword">from</span> <span class="string">'./constants'</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listReplies</span>(<span class="params">replies = []</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(replies.length &gt; MAX_REPLIES)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// display-watchers.js</span></div><div class="line"><span class="keyword">import</span> &#123; MAX_USERS &#125; <span class="keyword">from</span> <span class="string">'./constants'</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayWatchers</span>(<span class="params">watchers = []</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(watchers.length &gt; MAX_USERS)&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Class-Modules"><a href="#Class-Modules" class="headerlink" title="Class Modules"></a>Class Modules</h3><ul><li>Exporting Class Modules With Default Export</li><li>Using Class Modules With Named Export</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// flash-message.js</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FlashMessage</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(message)&#123;</div><div class="line">    <span class="keyword">this</span>.message = message;</div><div class="line">  &#125;</div><div class="line">  renderAlert()&#123;</div><div class="line">    alert(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.message&#125;</span> from alert`</span>);</div><div class="line">  &#125;</div><div class="line">  renderLog()&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.message&#125;</span> from log`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> &#123; FlashMessage &#125;</div><div class="line"></div><div class="line"><span class="comment">// app.js</span></div><div class="line"><span class="keyword">import</span> &#123; FlashMessage &#125; <span class="keyword">from</span> <span class="string">'./flash-message'</span>;</div><div class="line"><span class="keyword">let</span> flash = <span class="keyword">new</span> FlashMessage(<span class="string">"Hello"</span>);</div><div class="line">flash.renderAlert();</div><div class="line">flash.renderLog();</div></pre></td></tr></table></figure><h1 id="Promises-Iterators-and-Generators"><a href="#Promises-Iterators-and-Generators" class="headerlink" title="Promises, Iterators, and Generators"></a>Promises, Iterators, and Generators</h1><h2 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h2><p><strong>Fetching Poll Results From the Server</strong></p><p>It’s very important to understand how to work with JavaScript’s single-thread model.</p><p>Otherwise, we might accidentally freeze the entire app, to the detriment of user experience.</p><p><img src="/images/fetching-poll-results-from-the-server.png" alt="fetching-poll-results-from-the-server"></p><p><strong>Avoiding Code That Blocks</strong></p><p>Once the browser blocks executing a script, it stops running other scripts, rendering elements, and responding to user events like keyboard and mouse interactions.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Synchronous style functions wait for return values</span></div><div class="line"><span class="comment">// Page freezes until a value is returned from this function</span></div><div class="line"><span class="keyword">let</span> results = getPollResultsFromServer(<span class="string">"Sass vs. LESS"</span>);</div><div class="line">ui.renderSidebar(results);</div></pre></td></tr></table></figure><p>In order to avoid blocking the main thread of execution, we write non-blocking code like this:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Asynchronous style functions pass callbacks</span></div><div class="line">getPollResultsFromServer(<span class="string">"Sass vs. Less"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">results</span>)</span>&#123;</div><div class="line">  ui.renderSidebar(results);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p><strong>Passing Callbacks to Continue Execution</strong></p><p>In continuation-passing style (CPS) async programming, we tell a function how to continue execution by passing callbacks. It can grow to complicated nested code.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// When nested callbacks start to grow, our code becomes harder to understand</span></div><div class="line">getPollResultsFromServer(pollName, <span class="function"><span class="keyword">function</span>(<span class="params">error, results</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(error)&#123; <span class="comment">//.. handle error &#125;</span></div><div class="line">    <span class="comment">//...</span></div><div class="line">    ui.renderSidebar(results, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span>(error)&#123; <span class="comment">//.. handle error &#125;</span></div><div class="line">        <span class="comment">//...</span></div><div class="line">        sendNotificationToServer(pollName, results, <span class="function"><span class="keyword">function</span>(<span class="params">error, response</span>)</span>&#123;</div><div class="line">          <span class="keyword">if</span>(error)&#123; <span class="comment">//.. handle error &#125;</span></div><div class="line">            <span class="comment">//...</span></div><div class="line">            doSomethingElseNonBlocking(response, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">              <span class="keyword">if</span>(error)&#123; <span class="comment">//.. handle error &#125;</span></div><div class="line">                <span class="comment">//...</span></div><div class="line">            &#125;)</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p><strong>Using Promises</strong></p><p>A Promise is a new abstraction that allows us to write async code in an easier way.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Still non-blocking, but not using nested callbacks anymore</span></div><div class="line">getPollResultsFromServer(<span class="string">"Sass vs. LESS"</span>)</div><div class="line">  .then(ui.renderSidebar)</div><div class="line">  .then(sendNotificationToServer)</div><div class="line">  .then(doSomethingElseNonBlocking)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Error: "</span>, error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure><p><strong>The Lifecycle of a Promise Object</strong></p><p>Creating a new Promise automatically sets it to the pending state. Then, it can do 1 of 2 things: become fulfilled or rejected.</p><p><img src="/images/the-lifecycle-of a promise-object.png" alt="the-lifecycle-of a promise-object"></p><p><strong>Creating a New Promise Object</strong></p><p>The Promise constructor function takes an anonymous function with 2 callback arguments known as handlers.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPollResultsFromServer</span>(<span class="params">pollName</span>)</span>&#123;</div><div class="line">  <span class="comment">// Handlers are responsible for either resolving or rejecting the Promise</span></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>( <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">    <span class="comment">// Called when the non-blocking code is done executing</span></div><div class="line">    resolve(someValue);</div><div class="line">    <span class="comment">//...</span></div><div class="line">    <span class="comment">// Called when an error occurs</span></div><div class="line">    reject(someValue);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p><strong>Resolving a Promise</strong></p><p>Let’s wrap the XMLHttpRequest object API within a Promise. Calling the resolve() handler moves the Promise to a fulfilled state.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPollResultsFromServer</span>(<span class="params">pollName</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">    <span class="keyword">let</span> url = <span class="string">`/results/<span class="subst">$&#123;pollName&#125;</span>`</span>;</div><div class="line">    <span class="keyword">let</span> request = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">    request.open(<span class="string">'GET'</span>, url, <span class="literal">true</span>);</div><div class="line">    request.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (request.status &gt;= <span class="number">200</span> &amp;&amp; request.status &lt; <span class="number">400</span>) &#123;</div><div class="line">        <span class="comment">// We call the resolve() handler upon a successful response</span></div><div class="line">        <span class="comment">// Resolving a Promise moves it to a fulfilled state</span></div><div class="line">        resolve(<span class="built_in">JSON</span>.parse(request.response));</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//...</span></div><div class="line">    request.send();</div><div class="line">  &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p><strong>Reading Results From a Promise</strong></p><p>We can use the then() method to read results from the Promise once it’s resolved. This method takes a function that will only be invoked once the Promise is resolved.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">getPollResultsFromServer(<span class="string">"Sass vs. Less"</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">results</span>)</span>&#123; </div><div class="line">    ui.renderSidebar(results);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure><p><strong>Chaining Multiple Thens</strong></p><p>We can also chain multiple calls to then() ? the return value from 1 call is passed as argument to the next.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">getPollResultsFromServer(<span class="string">"Sass vs. Less"</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">results</span>)</span>&#123;</div><div class="line">    <span class="comment">// Only returns poll results from Orlando</span></div><div class="line">    <span class="keyword">return</span> results.filter(<span class="function">(<span class="params">result</span>) =&gt;</span> result.city === <span class="string">"Orlando"</span>);</div><div class="line">  &#125;)</div><div class="line">  <span class="comment">// The return value from one call to then</span></div><div class="line">  <span class="comment">// becomes the argument to the following call to then.</span></div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">resultsFromOrlando</span>)</span>&#123;</div><div class="line">    ui.renderSidebar(resultsFromOrlando);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure><p><strong>Rejecting a Promise</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPollResultsFromServer</span>(<span class="params">pollName</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">    request.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (request.status &gt;= <span class="number">200</span> &amp;&amp; request.status &lt; <span class="number">400</span>) &#123;</div><div class="line">        resolve(request.response);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// We call the reject() handler,passing it a new Error object</span></div><div class="line">        <span class="comment">// Rejecting a Promise moves it to a rejected state</span></div><div class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(request.status));</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">    request.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Error Fetching Results"</span>));</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//...</span></div></pre></td></tr></table></figure><p><strong>Catching Rejected Promises</strong></p><p>Once an error occurs, execution moves immediately to the catch() function. None of the remaining then() functions are invoked.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// When an error occurs here</span></div><div class="line">getPollResultsFromServer(<span class="string">"Sass vs. Less"</span>)</div><div class="line">  <span class="comment">// then none of these run</span></div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">results</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> results.filter(<span class="function">(<span class="params">result</span>) =&gt;</span> result.city === <span class="string">"Orlando"</span>);</div><div class="line">  &#125;)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">resultsFromOrlando</span>)</span>&#123;</div><div class="line">    ui.renderSidebar(resultsFromOrlando);</div><div class="line">  &#125;)</div><div class="line">  <span class="comment">// and execution moves straight here.</span></div><div class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Error: "</span>, error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure><p><strong>Passing Functions as Arguments</strong></p><p>We can make our code more succinct by passing function arguments to then, instead of using anonymous functions.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">filterResults</span>(<span class="params">results</span>)</span>&#123; <span class="comment">//... &#125;</span></div><div class="line"><span class="keyword">let</span> ui = &#123;</div><div class="line">  renderSidebar(filteredResults)&#123; <span class="comment">//... &#125;</span></div><div class="line">&#125;;</div><div class="line">  </div><div class="line">getPollResultsFromServer(<span class="string">"Sass vs. Less"</span>)</div><div class="line">  <span class="comment">// Passing function arguments make this code easier to read</span></div><div class="line">  .then(filterResults)</div><div class="line">  .then(ui.renderSidebar)</div><div class="line">  <span class="comment">// Still catches all errors from previous calls</span></div><div class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Error: "</span>, error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure><h2 id="Iterators"><a href="#Iterators" class="headerlink" title="Iterators"></a>Iterators</h2><p><strong>Iterables Return Iterators</strong></p><p>Iterables return an iterator object. This object knows how to access items from a collection 1 at a time, while keeping track of its current position within the sequence.</p><p><img src="/images/iterables-return-iterators.png" alt="iterables-return-iterators"></p><p><strong>Understanding the next Method</strong></p><p>Each time next() is called, it returns an object with 2 specific properties: done and value.</p><p>Here’s how values from these 2 properties work:</p><ul><li><code>done (boolean)</code><ul><li>Will be <code>false</code> if the iterator is able to return a value from the collection</li><li>Will be <code>true</code> if the iterator is past the end of the collection</li></ul></li><li><code>value (any)</code><ul><li>Any value returned by the iterator. When done is true, this returns <code>undefined</code>.</li></ul></li></ul><p><strong>Custom Iterator</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> post = &#123; &#125;; <span class="comment">//...</span></div><div class="line">post[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">// Returns an array with property names</span></div><div class="line">  <span class="keyword">let</span> properties = <span class="built_in">Object</span>.keys(<span class="keyword">this</span>);</div><div class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</div><div class="line">  <span class="keyword">let</span> isDone = <span class="literal">false</span>;</div><div class="line">  </div><div class="line">  <span class="keyword">let</span> next = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="comment">// Ends the loop after reaching the last property</span></div><div class="line">    <span class="keyword">if</span>(count &gt;= properties.length)&#123;</div><div class="line">      isDone = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// Fetches the value for the next property</span></div><div class="line">    <span class="comment">// ++ only increments count after it's read</span></div><div class="line">    <span class="keyword">return</span> &#123; <span class="attr">done</span>: isDone, <span class="attr">value</span>: <span class="keyword">this</span>[properties[count++]] &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> &#123; next &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><p><strong>Generator Functions</strong></p><p>The function * declaration defines generator functions. These are special functions from which we can use the yield keyword to return iterator objects.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">nameList</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">"Sam"</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">"Tyler"</span>;</div><div class="line">&#125;.</div></pre></td></tr></table></figure><blockquote><p>Doesn’t matter where we place the star, as long as it’s the first thing after the function keyword</p><ul><li>function *nameList(){</li></ul><ul><li>function* nameList(){</li></ul><ul><li>function * nameList(){</li></ul></blockquote><p><strong>Generator Objects and for…of</strong></p><p>Generator functions return objects that provide the same next method expected by for…of, the spread operator, and the destructuring assignment.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">nameList</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">"Sam"</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">"Tyler"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> name <span class="keyword">of</span> nameList())&#123;</div><div class="line">  <span class="built_in">console</span>.log( name );</div><div class="line">&#125;</div><div class="line"><span class="comment">// Sam</span></div><div class="line"><span class="comment">// Tyler</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> names = [...nameList()];</div><div class="line"><span class="built_in">console</span>.log( names ); <span class="comment">// ["Sam", "Tyler"]</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [first, second] = nameList();</div><div class="line"><span class="built_in">console</span>.log( first, second ); <span class="comment">//  Sam Tyler</span></div></pre></td></tr></table></figure><p><strong>Replacing Manual Iterator Objects</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> post = &#123; <span class="attr">title</span>: <span class="string">"New Features in JS"</span>, <span class="attr">replies</span>: <span class="number">19</span> &#125;;</div><div class="line">post[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span> *(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> properties = <span class="built_in">Object</span>.keys(<span class="keyword">this</span>);</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">of</span> properties)&#123;</div><div class="line">    <span class="keyword">yield</span> <span class="keyword">this</span>[p];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">of</span> post)&#123;</div><div class="line">  <span class="built_in">console</span>.log( p );</div><div class="line">&#125;</div><div class="line"><span class="comment">// New Features in JS</span></div><div class="line"><span class="comment">// 19</span></div></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author:</strong> Yusu Pan</li><li class="post-copyright-link"><strong>Post link:</strong> <a href="http://www.yuthon.com/2016/04/10/CodeSchool-ES2015/" title="Notes for Code School - ES2015">http://www.yuthon.com/2016/04/10/CodeSchool-ES2015/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/CodeSchool/" rel="tag"># CodeSchool</a> <a href="/tags/JavaScript/" rel="tag"># JavaScript</a> <a href="/tags/ES2015/" rel="tag"># ES2015</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2016/04/09/CodeSchool-Javascript/" rel="next" title="Notes for Code School - JavaScript Road Trip"><i class="fa fa-chevron-left"></i> Notes for Code School - JavaScript Road Trip</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2016/04/11/Tips-for-Hexo-configuration/" rel="prev" title="Tips for Hexo configuration">Tips for Hexo configuration <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">Table of Contents</li><li class="sidebar-nav-overview" data-target="site-overview">Overview</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/uploads/avatar.png" alt="Yusu Pan"><p class="site-author-name" itemprop="name">Yusu Pan</p><p class="site-description motion-element" itemprop="description">We've been gaining one good thing through losing another.</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">44</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">54</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/corenel" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="https://twitter.com/corenel" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i> Twitter </a></span><span class="links-of-author-item"><a href="http://www.zhihu.com/people/pan-yu-su" target="_blank" title="Zhihu"><i class="fa fa-fw fa-globe"></i> Zhihu</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></section><!--noindex--><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Declaration"><span class="nav-number">1.</span> <span class="nav-text">Declaration</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-let"><span class="nav-number">1.1.</span> <span class="nav-text">Using let</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-let-in-for-loops"><span class="nav-number">1.2.</span> <span class="nav-text">Using let in for loops</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-const"><span class="nav-number">1.3.</span> <span class="nav-text">Using const</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Functions"><span class="nav-number">2.</span> <span class="nav-text">Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Function-Defaults"><span class="nav-number">2.1.</span> <span class="nav-text">Function Defaults</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rest-Params-Spread-Op-Arrow-Func"><span class="nav-number">2.2.</span> <span class="nav-text">Rest Params, Spread Op, Arrow Func</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Rest-Parameters"><span class="nav-number">2.2.1.</span> <span class="nav-text">Rest Parameters</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spread-Operator"><span class="nav-number">2.2.2.</span> <span class="nav-text">Spread Operator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Arrow-Functions"><span class="nav-number">2.2.3.</span> <span class="nav-text">Arrow Functions</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Objects-Strings-and-Object-assign"><span class="nav-number">3.</span> <span class="nav-text">Objects, Strings, and Object.assign</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Objects"><span class="nav-number">3.1.</span> <span class="nav-text">Objects</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Strings"><span class="nav-number">3.2.</span> <span class="nav-text">Strings</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Object-assign"><span class="nav-number">3.3.</span> <span class="nav-text">Object.assign</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Arrays-Maps-and-Sets"><span class="nav-number">4.</span> <span class="nav-text">Arrays, Maps, and Sets</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Arrays"><span class="nav-number">4.1.</span> <span class="nav-text">Arrays</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Array-Destructuring"><span class="nav-number">4.1.1.</span> <span class="nav-text">Array Destructuring</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for…of"><span class="nav-number">4.1.2.</span> <span class="nav-text">for…of</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Array-find"><span class="nav-number">4.1.3.</span> <span class="nav-text">Array.find</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Maps"><span class="nav-number">4.2.</span> <span class="nav-text">Maps</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maps-and-Objects"><span class="nav-number">4.2.1.</span> <span class="nav-text">Maps and Objects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WeakMap"><span class="nav-number">4.2.2.</span> <span class="nav-text">WeakMap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sets"><span class="nav-number">4.3.</span> <span class="nav-text">Sets</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Sets-and-Arrays"><span class="nav-number">4.3.1.</span> <span class="nav-text">Sets and Arrays</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WeakSet"><span class="nav-number">4.3.2.</span> <span class="nav-text">WeakSet</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Classes-and-Modules"><span class="nav-number">5.</span> <span class="nav-text">Classes and Modules</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Classes"><span class="nav-number">5.1.</span> <span class="nav-text">Classes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Modules"><span class="nav-number">5.2.</span> <span class="nav-text">Modules</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-Modules"><span class="nav-number">5.2.1.</span> <span class="nav-text">Function Modules</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Export-and-import-Constants"><span class="nav-number">5.2.2.</span> <span class="nav-text">Export and import Constants</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Class-Modules"><span class="nav-number">5.2.3.</span> <span class="nav-text">Class Modules</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Promises-Iterators-and-Generators"><span class="nav-number">6.</span> <span class="nav-text">Promises, Iterators, and Generators</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Promises"><span class="nav-number">6.1.</span> <span class="nav-text">Promises</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Iterators"><span class="nav-number">6.2.</span> <span class="nav-text">Iterators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Generator"><span class="nav-number">6.3.</span> <span class="nav-text">Generator</span></a></li></ol></li></ol></div></div></section><!--/noindex--></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2015 - <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yusu Pan</span></div><div class="powered-by">Powered by <a class="theme-link" href="https://hexo.io">Hexo</a></div><div class="theme-info">Theme - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script><script id="dsq-count-scr" src="https://yuthons-blog.disqus.com/count.js" async></script><script type="text/javascript">var disqus_config = function () {
          this.page.url = 'http://www.yuthon.com/2016/04/10/CodeSchool-ES2015/';
          this.page.identifier = '2016/04/10/CodeSchool-ES2015/';
          this.page.title = 'Notes for Code School - ES2015';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://yuthons-blog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);</script><script type="text/javascript">// Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>